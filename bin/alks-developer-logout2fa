#!/usr/bin/env node
'use strict';

process.title = 'ALKS';

const program = require('commander');
const clc = require('cli-color');
const config = require('../package.json');
const utils = require('../lib/utils');
const Developer = require('../lib/developer');
const checkForUpdate = require('../lib/checkForUpdate').checkForUpdate;

program
  .version(config.version)
  .description('removes alks refresh token')
  .option('-v, --verbose', 'be verbose')
  .parse(process.argv);

const logger = 'dev-logout2fa';

if (Developer.removeToken()) {
  console.error(clc.white('Token removed!'));
} else {
  console.error(clc.red.bold('Error removing token!'));
}

(async function () {
  utils.log(program, logger, 'checking for updates');
  await checkForUpdate();
  await Developer.trackActivity(logger);
})().catch((err) => utils.errorAndExit(err.message, err));
